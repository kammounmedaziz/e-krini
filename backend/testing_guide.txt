# Testing Guide for Car Rental Platform Services (Swagger)

This guide provides instructions for testing the Assurance Claims, Maintenance, and Promotion Coupon services using Swagger UI. Each service requires authentication via JWT tokens obtained from the Auth Service.

## Prerequisites
- All services running via `docker-compose up -d` from the `backend/` directory
- Access to Swagger UI for each service (if available) or use tools like Postman/cURL
- Valid user accounts with appropriate roles

## General Authentication Steps
1. Access Auth Service Swagger: http://localhost:3001/api-docs (if available)
2. Register/Login endpoint: POST /api/auth/login
3. Get JWT token from response
4. Use token in Authorization header: `Bearer <token>` for all service requests

## 1. Assurance Claims Service (Port: 3004)
**Swagger URL:** http://localhost:3004/api-docs (if configured)

### Required User Roles:
- **Client**: To file insurance claims and view own claims
- **Agency**: To manage and process claims

### Testing Steps:
1. Login as Client:
   - Use credentials for a client user (e.g., username: "client_user", role: "client")
   - Get access token

2. Test Client Endpoints:
   - GET /api/claims/my-claims - View personal claims
   - POST /api/claims/file-claim - File a new insurance claim
   - PUT /api/claims/{id}/update - Update claim status/details

3. Login as Agency:
   - Use credentials for an agency user (e.g., username: "agency_user", role: "agency")
   - Get access token

4. Test Agency Endpoints:
   - GET /api/claims/all - View all claims
   - PUT /api/claims/{id}/process - Process/update claim status
   - POST /api/claims/{id}/approve - Approve claim

## 2. Maintenance Service (Port: 3007)
**Swagger URL:** http://localhost:3007/api-docs (if configured)

### Required User Roles:
- **Agency**: To schedule and manage vehicle maintenance
- **Admin**: To oversee all maintenance operations (if applicable)

### Testing Steps:
1. Login as Agency:
   - Use credentials for an agency user (e.g., username: "agency_user", role: "agency")
   - Get access token

2. Test Maintenance Endpoints:
   - GET /api/maintenance/vehicle/{vehicleId} - View maintenance history for a vehicle
   - POST /api/maintenance/schedule - Schedule new maintenance
   - PUT /api/maintenance/{id}/complete - Mark maintenance as completed
   - GET /api/maintenance/upcoming - View upcoming maintenance tasks

## 3. Promotion Coupon Service (Port: 3006)
**Swagger URL:** http://localhost:3006/api-docs (if configured)

### Required User Roles:
- **Client**: To view and apply available coupons
- **Admin**: To create, manage, and validate coupons

### Testing Steps:
1. Login as Client:
   - Use credentials for a client user (e.g., username: "client_user", role: "client")
   - Get access token

2. Test Client Endpoints:
   - GET /api/promotions/available - View available coupons
   - POST /api/promotions/{code}/apply - Apply coupon to reservation
   - GET /api/promotions/my-coupons - View applied coupons

3. Login as Admin:
   - Use credentials for an admin user (e.g., username: "admin_user", role: "admin")
   - Get access token

4. Test Admin Endpoints:
   - POST /api/promotions/create - Create new coupon
   - GET /api/promotions/all - View all coupons
   - PUT /api/promotions/{id}/update - Update coupon details
   - DELETE /api/promotions/{id} - Delete coupon

## Notes
- Ensure the Auth Service is running and accessible for token generation
- Tokens expire (typically 15 minutes), refresh if needed
- Some endpoints may require specific data (vehicle IDs, claim details, etc.)
- Test both success and error scenarios
- Check service logs for any issues during testing

## Troubleshooting
- 401 Unauthorized: Check token validity and expiration
- 403 Forbidden: Verify user role permissions
- 404 Not Found: Confirm endpoint URLs and service availability
- Service unavailable: Check docker-compose status and logs